# Sanity CMS Integration for AutoUp Blog

Replace the hardcoded blog content with a Sanity-powered CMS. After this, Ken can write and publish blog posts from a visual editor at `https://autoup.sanity.studio` without touching code. The blog pages, SEO meta tags, sitemap, and Article structured data will all pull from Sanity automatically.

**Important:** The visual design of the blog index page and blog post pages should NOT change at all. Same layout, same fonts, same colors, same spacing. We're only swapping where the data comes from.

---

## Part 1: Sanity Project Setup (Manual — Do This First)

Before touching any code, go to [sanity.io/manage](https://www.sanity.io/manage) and:

1. Create a free account (if you don't have one)
2. Create a new project called "AutoUp Blog"
3. Choose the free plan
4. Note your **Project ID** — you'll need it below
5. Under Settings → API → CORS Origins, add:
   - `http://localhost:5000` (for local dev)
   - `https://autoup.io` (for production)
   - `https://*.replit.dev` (for Replit preview)
6. Under Settings → API → Tokens, create a read-only token (label it "Frontend Read") — note this token
7. The dataset name will be `production` (the default)

---

## Part 2: Install Dependencies

Run in the Replit shell:

```bash
npm install @sanity/client @sanity/image-url @portabletext/react
```

---

## Part 3: Create Sanity Client — `client/src/lib/sanity.ts`

Create this new file:

```ts
import { createClient } from "@sanity/client";
import imageUrlBuilder from "@sanity/image-url";

export const sanityClient = createClient({
  projectId: import.meta.env.VITE_SANITY_PROJECT_ID || "YOUR_PROJECT_ID",
  dataset: "production",
  apiVersion: "2024-01-01",
  useCdn: true,
});

const builder = imageUrlBuilder(sanityClient);

export function urlFor(source: any) {
  return builder.image(source);
}
```

Then add these environment variables in Replit's Secrets tab (or `.env`):
```
VITE_SANITY_PROJECT_ID=your_project_id_here
```

---

## Part 4: Create Sanity Studio — `sanity/` directory

Create a minimal embedded Sanity Studio so you can manage content. Create these files:

### `sanity/sanity.config.ts`

```ts
import { defineConfig } from "sanity";
import { structureTool } from "sanity/structure";
import { schemaTypes } from "./schemas";

export default defineConfig({
  name: "autoup-blog",
  title: "AutoUp Blog",
  projectId: process.env.SANITY_PROJECT_ID || "YOUR_PROJECT_ID",
  dataset: "production",
  plugins: [structureTool()],
  schema: {
    types: schemaTypes,
  },
});
```

### `sanity/schemas/index.ts`

```ts
import { post } from "./post";
import { category } from "./category";
import { author } from "./author";

export const schemaTypes = [post, category, author];
```

### `sanity/schemas/post.ts`

```ts
import { defineField, defineType } from "sanity";

export const post = defineType({
  name: "post",
  title: "Blog Post",
  type: "document",
  fields: [
    defineField({
      name: "title",
      title: "Title",
      type: "string",
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: "slug",
      title: "Slug",
      type: "slug",
      options: { source: "title", maxLength: 96 },
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: "excerpt",
      title: "Excerpt",
      type: "text",
      rows: 3,
      description: "Short summary for blog index cards and meta description",
      validation: (Rule) => Rule.required().max(200),
    }),
    defineField({
      name: "author",
      title: "Author",
      type: "reference",
      to: [{ type: "author" }],
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: "category",
      title: "Category",
      type: "reference",
      to: [{ type: "category" }],
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: "publishedAt",
      title: "Published At",
      type: "datetime",
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: "readTime",
      title: "Read Time",
      type: "string",
      description: 'e.g. "8 min read"',
    }),
    defineField({
      name: "ogImage",
      title: "OG Image",
      type: "image",
      description: "Social sharing image (1200x630 recommended)",
      options: { hotspot: true },
    }),
    defineField({
      name: "body",
      title: "Body",
      type: "array",
      of: [
        {
          type: "block",
          styles: [
            { title: "Normal", value: "normal" },
            { title: "H2", value: "h2" },
            { title: "H3", value: "h3" },
            { title: "Quote", value: "blockquote" },
          ],
          marks: {
            decorators: [
              { title: "Bold", value: "strong" },
              { title: "Italic", value: "em" },
            ],
            annotations: [
              {
                name: "link",
                type: "object",
                title: "Link",
                fields: [
                  {
                    name: "href",
                    type: "url",
                    title: "URL",
                  },
                ],
              },
            ],
          },
        },
        {
          type: "image",
          options: { hotspot: true },
          fields: [
            {
              name: "alt",
              type: "string",
              title: "Alt Text",
            },
            {
              name: "caption",
              type: "string",
              title: "Caption",
            },
          ],
        },
      ],
    }),
  ],
  orderings: [
    {
      title: "Published Date, New",
      name: "publishedAtDesc",
      by: [{ field: "publishedAt", direction: "desc" }],
    },
  ],
  preview: {
    select: {
      title: "title",
      author: "author.name",
      date: "publishedAt",
    },
    prepare({ title, author, date }) {
      return {
        title,
        subtitle: `${author || "No author"} — ${date ? new Date(date).toLocaleDateString() : "No date"}`,
      };
    },
  },
});
```

### `sanity/schemas/category.ts`

```ts
import { defineField, defineType } from "sanity";

export const category = defineType({
  name: "category",
  title: "Category",
  type: "document",
  fields: [
    defineField({
      name: "title",
      title: "Title",
      type: "string",
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: "colorClass",
      title: "Color Class",
      type: "string",
      description: "Tailwind classes for the category badge, e.g. 'bg-blue-50 text-blue-700'",
    }),
  ],
});
```

### `sanity/schemas/author.ts`

```ts
import { defineField, defineType } from "sanity";

export const author = defineType({
  name: "author",
  title: "Author",
  type: "document",
  fields: [
    defineField({
      name: "name",
      title: "Name",
      type: "string",
      validation: (Rule) => Rule.required(),
    }),
    defineField({
      name: "image",
      title: "Image",
      type: "image",
      options: { hotspot: true },
    }),
  ],
  preview: {
    select: { title: "name", media: "image" },
  },
});
```

---

## Part 5: Sanity Data Queries — `client/src/lib/sanityQueries.ts`

Create this file with all the GROQ queries:

```ts
import { sanityClient } from "./sanity";

// Types
export interface SanityPost {
  _id: string;
  title: string;
  slug: string;
  excerpt: string;
  category: string;
  categoryColor: string;
  author: string;
  publishedAt: string;
  readTime: string;
  ogImage?: string;
  body?: any[];
}

// Get all posts for the blog index
export async function getAllPosts(): Promise<SanityPost[]> {
  return sanityClient.fetch(`
    *[_type == "post"] | order(publishedAt desc) {
      _id,
      title,
      "slug": slug.current,
      excerpt,
      "category": category->title,
      "categoryColor": category->colorClass,
      "author": author->name,
      publishedAt,
      readTime
    }
  `);
}

// Get a single post by slug
export async function getPostBySlug(slug: string): Promise<SanityPost | null> {
  const results = await sanityClient.fetch(
    `
    *[_type == "post" && slug.current == $slug][0] {
      _id,
      title,
      "slug": slug.current,
      excerpt,
      "category": category->title,
      "categoryColor": category->colorClass,
      "author": author->name,
      publishedAt,
      readTime,
      "ogImage": ogImage.asset->url,
      body
    }
  `,
    { slug }
  );
  return results;
}

// Get all slugs (for sitemap)
export async function getAllSlugs(): Promise<string[]> {
  return sanityClient.fetch(`
    *[_type == "post"].slug.current
  `);
}

// Get adjacent posts for prev/next navigation
export async function getAdjacentPosts(publishedAt: string) {
  const [prev, next] = await Promise.all([
    sanityClient.fetch(
      `*[_type == "post" && publishedAt < $date] | order(publishedAt desc) [0] {
        title, "slug": slug.current
      }`,
      { date: publishedAt }
    ),
    sanityClient.fetch(
      `*[_type == "post" && publishedAt > $date] | order(publishedAt asc) [0] {
        title, "slug": slug.current
      }`,
      { date: publishedAt }
    ),
  ]);
  return { prev, next };
}
```

---

## Part 6: Replace `client/src/pages/Blog.tsx`

Replace the entire file. This fetches posts from Sanity instead of the hardcoded array. The visual output is identical — same card layout, same categories, same styling.

```tsx
import { useState, useEffect } from "react";
import { Link } from "wouter";
import { ArrowUpRight, Clock, User } from "lucide-react";
import { Reveal } from "@/components/ui/reveal";
import { Navigation } from "@/components/sections/Navigation";
import { Footer } from "@/components/sections/Footer";
import { usePageMeta } from "@/hooks/usePageMeta";
import { getAllPosts, type SanityPost } from "@/lib/sanityQueries";

const defaultCategoryColors: Record<string, string> = {
  "Email Strategy": "bg-blue-50 text-blue-700",
  "AI & Automation": "bg-purple-50 text-purple-700",
  "Sales Strategy": "bg-emerald-50 text-emerald-700",
  "LinkedIn": "bg-sky-50 text-sky-700",
  "Copywriting": "bg-amber-50 text-amber-700",
};

function formatDate(dateString: string): string {
  return new Date(dateString).toLocaleDateString("en-US", {
    month: "short",
    day: "numeric",
    year: "numeric",
  });
}

export default function Blog() {
  const [posts, setPosts] = useState<SanityPost[]>([]);
  const [loading, setLoading] = useState(true);

  usePageMeta({
    title: "Blog — AutoUp | Cold Email Outbound Strategies & Insights",
    description: "The strategies, frameworks, and insights behind the AutoUp system. Learn about cold email deliverability, B2B lead generation, and outbound sales.",
    canonical: "https://autoup.io/blog",
  });

  useEffect(() => {
    getAllPosts()
      .then(setPosts)
      .catch(console.error)
      .finally(() => setLoading(false));
  }, []);

  return (
    <div className="min-h-screen bg-white">
      <Navigation />

      <section className="pt-36 pb-6 md:pt-40 md:pb-8 overflow-hidden relative bg-white">
        <div className="container mx-auto px-4 md:px-6 text-center">
          <Reveal>
            <span className="text-[13px] font-bold uppercase tracking-[3px] text-teal mb-6 block">The AutoUp System</span>
          </Reveal>
          <Reveal delay={0.1}>
            <h1 className="text-4xl md:text-6xl lg:text-7xl font-bold tracking-tight mb-4 leading-[1.1] font-sans text-[#1e293b]">
              10,000+ Positive Replies.<br />
              <em className="text-teal">Every Month.</em>
            </h1>
          </Reveal>
          <Reveal delay={0.2}>
            <p className="text-[20px] md:text-[22px] text-[#64748b] max-w-[540px] mx-auto mb-8 leading-relaxed">
              The strategies, frameworks, and insights behind the system.
            </p>
          </Reveal>
        </div>
      </section>

      <main className="py-16">
        <div className="container mx-auto px-4 md:px-6">
          {loading ? (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              {[1, 2, 3].map((i) => (
                <div key={i} className="bg-gray-50 rounded-lg border border-gray-100 p-6 animate-pulse">
                  <div className="h-4 bg-gray-200 rounded w-1/4 mb-4" />
                  <div className="h-6 bg-gray-200 rounded w-3/4 mb-3" />
                  <div className="h-4 bg-gray-200 rounded w-full mb-2" />
                  <div className="h-4 bg-gray-200 rounded w-2/3" />
                </div>
              ))}
            </div>
          ) : (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              {posts.map((post, i) => (
                <Reveal key={post._id} delay={i * 0.05}>
                  <Link
                    href={`/blog/${post.slug}`}
                    className="group flex flex-col h-full bg-white rounded-lg border border-gray-100 overflow-visible hover-elevate transition-all"
                    data-testid={`blog-card-${post.slug}`}
                  >
                    <div className="p-6 flex flex-col flex-1">
                      <div className="flex items-center gap-3 mb-3">
                        <span className={`text-xs font-semibold px-2.5 py-1 rounded-full ${post.categoryColor || defaultCategoryColors[post.category] || "bg-gray-50 text-gray-700"}`}>
                          {post.category}
                        </span>
                        <span className="text-xs text-gray-400 flex items-center gap-1">
                          <Clock className="w-3 h-3" /> {post.readTime}
                        </span>
                      </div>
                      <h2 className="text-lg font-bold text-gray-900 mb-2 group-hover:text-[#4580F7] transition-colors leading-snug">
                        {post.title}
                      </h2>
                      <p className="text-sm text-gray-500 mb-4 flex-1 leading-relaxed">
                        {post.excerpt}
                      </p>
                      <div className="flex items-center justify-between gap-2 flex-wrap pt-4 border-t border-gray-50">
                        <div className="flex items-center gap-2 text-xs text-gray-400">
                          <User className="w-3 h-3" />
                          {post.author}
                        </div>
                        <span className="text-xs text-gray-400">{formatDate(post.publishedAt)}</span>
                      </div>
                    </div>
                  </Link>
                </Reveal>
              ))}
            </div>
          )}

          <div className="text-center mt-20 mb-8">
            <Reveal>
              <p className="text-lg text-gray-500 mb-6">Want results like these?</p>
              <a
                href="https://calendly.com/ken-autoup/autoup-introduction"
                target="_blank"
                rel="noopener noreferrer"
                className="inline-flex items-center gap-3 bg-[#4580F7] hover:bg-[#5090FF] text-white font-bold text-lg px-10 py-[18px] rounded-xl transition-all duration-200 ease-out shadow-[0_2px_12px_rgba(69,128,247,0.2)] hover:shadow-[0_6px_24px_rgba(0,0,0,0.25)]"
                data-testid="link-blog-cta"
              >
                Book Intro Call <ArrowUpRight className="w-5 h-5" />
              </a>
            </Reveal>
          </div>
        </div>
      </main>

      <Footer />
    </div>
  );
}
```

---

## Part 7: Replace `client/src/pages/BlogPost.tsx`

Replace the entire file. This fetches individual posts from Sanity, renders Portable Text (Sanity's rich text format), and injects per-post SEO meta tags and Article structured data.

```tsx
import { useState, useEffect } from "react";
import { Link, useParams } from "wouter";
import { ArrowLeft, ArrowRight, ArrowUpRight, Clock, User, Calendar } from "lucide-react";
import { PortableText } from "@portabletext/react";
import { Reveal } from "@/components/ui/reveal";
import { Navigation } from "@/components/sections/Navigation";
import { Footer } from "@/components/sections/Footer";
import { usePageMeta } from "@/hooks/usePageMeta";
import { getPostBySlug, getAdjacentPosts, type SanityPost } from "@/lib/sanityQueries";
import { urlFor } from "@/lib/sanity";

// Portable Text custom components — matches the existing blog styling exactly
const portableTextComponents = {
  block: {
    normal: ({ children }: any) => (
      <p className="text-gray-600 leading-relaxed mb-6 text-[17px]">{children}</p>
    ),
    h2: ({ children }: any) => (
      <h2 className="text-2xl font-bold text-gray-900 mt-10 mb-4 font-sans">{children}</h2>
    ),
    h3: ({ children }: any) => (
      <h3 className="text-xl font-bold text-gray-900 mt-8 mb-3 font-sans">{children}</h3>
    ),
    blockquote: ({ children }: any) => (
      <blockquote className="border-l-4 border-teal/40 pl-5 my-6 text-gray-500 italic text-[17px] leading-relaxed">
        {children}
      </blockquote>
    ),
  },
  marks: {
    link: ({ children, value }: any) => (
      <a
        href={value?.href}
        target="_blank"
        rel="noopener noreferrer"
        className="text-[#4580F7] underline hover:text-[#5090FF] transition-colors"
      >
        {children}
      </a>
    ),
  },
  types: {
    image: ({ value }: any) => {
      if (!value?.asset) return null;
      return (
        <figure className="my-8">
          <img
            src={urlFor(value).width(800).auto("format").url()}
            alt={value.alt || ""}
            className="rounded-lg w-full"
            loading="lazy"
          />
          {value.caption && (
            <figcaption className="text-sm text-gray-400 mt-2 text-center">{value.caption}</figcaption>
          )}
        </figure>
      );
    },
  },
};

function formatDate(dateString: string): string {
  return new Date(dateString).toLocaleDateString("en-US", {
    month: "short",
    day: "numeric",
    year: "numeric",
  });
}

export default function BlogPost() {
  const { slug } = useParams<{ slug: string }>();
  const [post, setPost] = useState<SanityPost | null>(null);
  const [adjacent, setAdjacent] = useState<{ prev: any; next: any }>({ prev: null, next: null });
  const [loading, setLoading] = useState(true);
  const [notFound, setNotFound] = useState(false);

  usePageMeta({
    title: post ? `${post.title} — AutoUp Blog` : "AutoUp Blog",
    description: post?.excerpt || "Cold email outbound strategies and insights from AutoUp.",
    canonical: post ? `https://autoup.io/blog/${post.slug}` : undefined,
    ogImage: post?.ogImage || "https://autoup.io/og-image.png",
    ogType: "article",
  });

  // Article structured data
  useEffect(() => {
    if (!post) return;

    const articleSchema = {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": post.title,
      "description": post.excerpt,
      "author": {
        "@type": "Person",
        "name": post.author,
      },
      "publisher": {
        "@type": "Organization",
        "name": "AutoUp",
        "logo": {
          "@type": "ImageObject",
          "url": "https://autoup.io/favicon.png",
        },
      },
      "datePublished": post.publishedAt,
      "mainEntityOfPage": `https://autoup.io/blog/${post.slug}`,
      ...(post.ogImage ? { image: post.ogImage } : {}),
    };

    const script = document.createElement("script");
    script.type = "application/ld+json";
    script.textContent = JSON.stringify(articleSchema);
    document.head.appendChild(script);

    return () => {
      script.remove();
    };
  }, [post]);

  useEffect(() => {
    if (!slug) return;
    setLoading(true);
    setNotFound(false);

    getPostBySlug(slug)
      .then((result) => {
        if (!result) {
          setNotFound(true);
        } else {
          setPost(result);
          getAdjacentPosts(result.publishedAt).then(setAdjacent);
        }
      })
      .catch(() => setNotFound(true))
      .finally(() => setLoading(false));
  }, [slug]);

  if (loading) {
    return (
      <div className="min-h-screen bg-white">
        <Navigation />
        <div className="pt-32 pb-20 container mx-auto px-4 md:px-6 max-w-3xl">
          <div className="animate-pulse">
            <div className="h-10 bg-gray-200 rounded w-3/4 mb-6" />
            <div className="h-4 bg-gray-200 rounded w-1/3 mb-12" />
            <div className="space-y-4">
              <div className="h-4 bg-gray-200 rounded w-full" />
              <div className="h-4 bg-gray-200 rounded w-full" />
              <div className="h-4 bg-gray-200 rounded w-2/3" />
            </div>
          </div>
        </div>
        <Footer />
      </div>
    );
  }

  if (notFound || !post) {
    return (
      <div className="min-h-screen bg-white">
        <Navigation />
        <div className="pt-32 pb-20 container mx-auto px-4 md:px-6 max-w-3xl text-center">
          <h1 className="text-3xl font-bold text-gray-900 mb-4">Post not found</h1>
          <p className="text-gray-500 mb-8">The post you're looking for doesn't exist or has been removed.</p>
          <Link href="/blog" className="text-[#4580F7] font-semibold hover:underline">
            ← Back to Blog
          </Link>
        </div>
        <Footer />
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-white">
      <Navigation />

      <article className="pt-32 pb-20">
        <div className="container mx-auto px-4 md:px-6 max-w-3xl">
          <Reveal>
            <div className="mb-8">
              <h1 className="text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-6 leading-tight font-sans" data-testid="text-post-title">
                {post.title}
              </h1>
              <div className="flex flex-wrap items-center gap-4 text-sm text-gray-400 mb-8">
                <span className="flex items-center gap-1.5"><User className="w-4 h-4" /> {post.author}</span>
                <span className="flex items-center gap-1.5"><Calendar className="w-4 h-4" /> {formatDate(post.publishedAt)}</span>
                <span className="flex items-center gap-1.5"><Clock className="w-4 h-4" /> {post.readTime}</span>
              </div>
            </div>
          </Reveal>

          <Reveal delay={0.2}>
            <div className="prose prose-lg max-w-none">
              {post.body && (
                <PortableText value={post.body} components={portableTextComponents} />
              )}
            </div>
          </Reveal>

          <Reveal delay={0.3}>
            <div className="mt-16 p-8 bg-gray-50 rounded-lg text-center">
              <h3 className="text-xl font-bold text-gray-900 mb-2 font-sans">Ready to scale your outreach?</h3>
              <p className="text-gray-500 mb-6">Book a free strategy call and see how AutoUp can build your pipeline.</p>
              <a
                href="https://calendly.com/ken-autoup/autoup-introduction"
                target="_blank"
                rel="noopener noreferrer"
                className="inline-flex items-center gap-2 bg-[#4580F7] hover:bg-[#5090FF] text-white font-bold px-6 py-3 rounded-lg transition-all duration-200 ease-out shadow-[0_2px_10px_rgba(69,128,247,0.2)] hover:shadow-[0_6px_24px_rgba(0,0,0,0.25)]"
                data-testid="link-post-cta"
              >
                Book Intro Call <ArrowUpRight className="w-4 h-4" />
              </a>
            </div>
          </Reveal>

          <div className="mt-12 flex items-center justify-between gap-4 pt-8 border-t border-gray-100">
            {adjacent.prev ? (
              <Link
                href={`/blog/${adjacent.prev.slug}`}
                className="flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-900 transition-colors max-w-[45%]"
                data-testid="link-prev-post"
              >
                <ArrowLeft className="w-4 h-4 flex-shrink-0" />
                <span className="hidden sm:inline">{adjacent.prev.title}</span>
                <span className="sm:hidden">Previous</span>
              </Link>
            ) : <div />}
            {adjacent.next ? (
              <Link
                href={`/blog/${adjacent.next.slug}`}
                className="flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-900 transition-colors text-right max-w-[45%]"
                data-testid="link-next-post"
              >
                <span className="hidden sm:inline">{adjacent.next.title}</span>
                <span className="sm:hidden">Next</span>
                <ArrowRight className="w-4 h-4 flex-shrink-0" />
              </Link>
            ) : <div />}
          </div>
        </div>
      </article>

      <Footer />
    </div>
  );
}
```

---

## Part 8: Update Sitemap to Pull from Sanity — `server/routes.ts`

Replace the hardcoded blog slugs in the sitemap with a dynamic fetch from Sanity. Update the sitemap route:

```ts
import { createClient } from "@sanity/client";

// Add this near the top of the file, before registerRoutes
const sanityServer = createClient({
  projectId: process.env.SANITY_PROJECT_ID || "YOUR_PROJECT_ID",
  dataset: "production",
  apiVersion: "2024-01-01",
  useCdn: true,
});
```

Then replace the existing `app.get("/sitemap.xml", ...)` block with:

```ts
app.get("/sitemap.xml", async (_req, res) => {
  const baseUrl = "https://autoup.io";
  const today = new Date().toISOString().split("T")[0];

  let blogSlugs: string[] = [];
  try {
    blogSlugs = await sanityServer.fetch(`*[_type == "post"].slug.current`);
  } catch (err) {
    console.error("Failed to fetch blog slugs for sitemap:", err);
  }

  const urls = [
    { loc: `${baseUrl}/`, changefreq: "weekly", priority: "1.0" },
    { loc: `${baseUrl}/blog`, changefreq: "weekly", priority: "0.8" },
    ...blogSlugs.map((slug) => ({
      loc: `${baseUrl}/blog/${slug}`,
      changefreq: "monthly" as const,
      priority: "0.7",
    })),
  ];

  const xml = `<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
${urls
  .map(
    (u) => `  <url>
    <loc>${u.loc}</loc>
    <lastmod>${today}</lastmod>
    <changefreq>${u.changefreq}</changefreq>
    <priority>${u.priority}</priority>
  </url>`
  )
  .join("\n")}
</urlset>`;

  res.header("Content-Type", "application/xml");
  res.send(xml);
});
```

Also add `@sanity/client` to the server-side dependencies (it's already installed from Part 2, just needs to be importable on the server).

---

## Part 9: Seed Existing Content into Sanity

After the Studio is deployed, you'll need to create the initial content. In the Sanity Studio:

1. **Create an Author**: "Ken at AutoUp"
2. **Create Categories**: "Email Strategy", "AI & Automation", "Sales Strategy", "LinkedIn", "Copywriting" — with their respective `colorClass` values (`bg-blue-50 text-blue-700`, etc.)
3. **Create the 6 existing posts** by copying the title, slug, excerpt, category, date, and body content from the current hardcoded data into the Sanity editor

This is a one-time migration. After that, all new posts go through the Studio.

---

## Summary

After implementation:

- **To publish a new post:** Go to `https://autoup.sanity.studio`, write the post in the visual editor, set the slug/excerpt/category/date, hit Publish. It appears on the site automatically.
- **SEO:** Every post gets unique `<title>`, meta description, OG tags, canonical URL, and Article structured data — all driven by the fields you fill in Sanity.
- **Sitemap:** Automatically includes every published post.
- **No code changes needed** to publish, edit, or remove posts.
- **Visual design:** Completely unchanged.

### Environment Variables Needed

```
VITE_SANITY_PROJECT_ID=your_project_id
SANITY_PROJECT_ID=your_project_id  (for server-side sitemap)
```